const t=(t={globalLimit:1})=>{const e={};let l=0;const i=(t={key:""})=>{const i=e[t.key];i.w.length>0?(i.w.shift()?.r(t),i.l--,l--):(i.l=0,l=0)};return{wait:async(s={key:"",limit:1})=>await new Promise((n=>{const o=()=>n((()=>i(s))),a=e[s.key]||(e[s.key]={l:0,w:[]});l>=t.globalLimit||a.l>=s.limit?a.w.push({r:o}):(l++,a.l++,o())})),release:i}};export{t as Mutex};
